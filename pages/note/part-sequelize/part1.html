<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ORM框架Sequelize | 秋枫残红的首页</title>
    <meta name="description" content="秋枫残红的前端记录">
    <link rel="icon" href="/logo.png">
    
    <link rel="preload" href="/assets/css/0.styles.1e617c1c.css" as="style"><link rel="preload" href="/assets/js/app.4e796291.js" as="script"><link rel="preload" href="/assets/js/2.5955c47d.js" as="script"><link rel="preload" href="/assets/js/42.2df722e2.js" as="script"><link rel="prefetch" href="/assets/js/10.023e598c.js"><link rel="prefetch" href="/assets/js/11.5d456fb5.js"><link rel="prefetch" href="/assets/js/12.a48b2b00.js"><link rel="prefetch" href="/assets/js/13.772c8218.js"><link rel="prefetch" href="/assets/js/14.c9a689e9.js"><link rel="prefetch" href="/assets/js/15.e0615018.js"><link rel="prefetch" href="/assets/js/16.5517e456.js"><link rel="prefetch" href="/assets/js/17.a5c720e2.js"><link rel="prefetch" href="/assets/js/18.5e7781f7.js"><link rel="prefetch" href="/assets/js/19.ce689d57.js"><link rel="prefetch" href="/assets/js/20.093ab0eb.js"><link rel="prefetch" href="/assets/js/21.b6e24c88.js"><link rel="prefetch" href="/assets/js/22.04c63522.js"><link rel="prefetch" href="/assets/js/23.df78c435.js"><link rel="prefetch" href="/assets/js/24.40aa88f0.js"><link rel="prefetch" href="/assets/js/25.a6a9d7e7.js"><link rel="prefetch" href="/assets/js/26.b3e9e28a.js"><link rel="prefetch" href="/assets/js/27.de39e65c.js"><link rel="prefetch" href="/assets/js/28.d2f133d4.js"><link rel="prefetch" href="/assets/js/29.9ff465c5.js"><link rel="prefetch" href="/assets/js/3.d3f6d4b4.js"><link rel="prefetch" href="/assets/js/30.2340f0f7.js"><link rel="prefetch" href="/assets/js/31.267d45b0.js"><link rel="prefetch" href="/assets/js/32.bc086275.js"><link rel="prefetch" href="/assets/js/33.dbe4e841.js"><link rel="prefetch" href="/assets/js/34.a04ad3b1.js"><link rel="prefetch" href="/assets/js/35.b13839ab.js"><link rel="prefetch" href="/assets/js/36.ff7d9cc1.js"><link rel="prefetch" href="/assets/js/37.9e9bda59.js"><link rel="prefetch" href="/assets/js/38.e1285c70.js"><link rel="prefetch" href="/assets/js/39.97f9aab7.js"><link rel="prefetch" href="/assets/js/4.be3fbf0d.js"><link rel="prefetch" href="/assets/js/40.5ccc1141.js"><link rel="prefetch" href="/assets/js/41.9af4572a.js"><link rel="prefetch" href="/assets/js/43.415554cc.js"><link rel="prefetch" href="/assets/js/44.fb1e0cd2.js"><link rel="prefetch" href="/assets/js/45.d54e6782.js"><link rel="prefetch" href="/assets/js/46.4be2f821.js"><link rel="prefetch" href="/assets/js/47.3a6aa224.js"><link rel="prefetch" href="/assets/js/48.e23e972b.js"><link rel="prefetch" href="/assets/js/49.e844112a.js"><link rel="prefetch" href="/assets/js/5.da4ea6b7.js"><link rel="prefetch" href="/assets/js/50.5b77c8c9.js"><link rel="prefetch" href="/assets/js/51.e6f5c89d.js"><link rel="prefetch" href="/assets/js/6.e197d4ff.js"><link rel="prefetch" href="/assets/js/7.daf8f688.js"><link rel="prefetch" href="/assets/js/8.0a387549.js"><link rel="prefetch" href="/assets/js/9.56278697.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1e617c1c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="秋枫残红的首页" class="logo"> <span class="site-name can-hide">秋枫残红的首页</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习笔记" class="dropdown-title"><span class="title">学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/note/part-html/part1.html" class="nav-link">Html</a></li><li class="dropdown-item"><!----> <a href="/pages/note/part-css/part1.html" class="nav-link">CSS</a></li><li class="dropdown-item"><!----> <a href="/pages/note/part-javascript/part1.html" class="nav-link">Javascript</a></li><li class="dropdown-item"><!----> <a href="/pages/note/part-ecmascript6/part1.html" class="nav-link">ECMAScript6</a></li><li class="dropdown-item"><!----> <a href="/pages/note/part-vue/part1.html" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/pages/note/part-react/part1.html" class="nav-link">React</a></li><li class="dropdown-item"><!----> <a href="/pages/note/part-node/part1.html" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/pages/note/part-sequelize/part1.html" class="nav-link router-link-exact-active router-link-active">Sequeize</a></li><li class="dropdown-item"><!----> <a href="/pages/note/part-redis/part1.html" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/pages/note/part-tool/part1.html" class="nav-link">开发工具</a></li><li class="dropdown-item"><!----> <a href="/pages/note/part-net/part1.html" class="nav-link">网络</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="日常踩坑" class="dropdown-title"><span class="title">日常踩坑</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/question/part-javascript/part1.html" class="nav-link">Javascript</a></li></ul></div></div><div class="nav-item"><a href="/pages/practice/part1.html" class="nav-link">每日一题</a></div><div class="nav-item"><a href="https://github.com/qiufengcanhong" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习笔记" class="dropdown-title"><span class="title">学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/note/part-html/part1.html" class="nav-link">Html</a></li><li class="dropdown-item"><!----> <a href="/pages/note/part-css/part1.html" class="nav-link">CSS</a></li><li class="dropdown-item"><!----> <a href="/pages/note/part-javascript/part1.html" class="nav-link">Javascript</a></li><li class="dropdown-item"><!----> <a href="/pages/note/part-ecmascript6/part1.html" class="nav-link">ECMAScript6</a></li><li class="dropdown-item"><!----> <a href="/pages/note/part-vue/part1.html" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/pages/note/part-react/part1.html" class="nav-link">React</a></li><li class="dropdown-item"><!----> <a href="/pages/note/part-node/part1.html" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/pages/note/part-sequelize/part1.html" class="nav-link router-link-exact-active router-link-active">Sequeize</a></li><li class="dropdown-item"><!----> <a href="/pages/note/part-redis/part1.html" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/pages/note/part-tool/part1.html" class="nav-link">开发工具</a></li><li class="dropdown-item"><!----> <a href="/pages/note/part-net/part1.html" class="nav-link">网络</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="日常踩坑" class="dropdown-title"><span class="title">日常踩坑</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/question/part-javascript/part1.html" class="nav-link">Javascript</a></li></ul></div></div><div class="nav-item"><a href="/pages/practice/part1.html" class="nav-link">每日一题</a></div><div class="nav-item"><a href="https://github.com/qiufengcanhong" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>sequelize</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/note/part-sequelize/part1.html" class="active sidebar-link">基本用法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#什么是orm" class="sidebar-link">什么是ORM</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#安装" class="sidebar-link">安装</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#建立连接" class="sidebar-link">建立连接</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#连接测试" class="sidebar-link">连接测试</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#模型建立" class="sidebar-link">模型建立</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#数据类型" class="sidebar-link">数据类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#char" class="sidebar-link">Char</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#number" class="sidebar-link">Number</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#time" class="sidebar-link">Time</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#boolean" class="sidebar-link">Boolean</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#enum" class="sidebar-link">ENUM</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#常见操作" class="sidebar-link">常见操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#属性" class="sidebar-link">属性</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#使用嵌套数组重命名" class="sidebar-link">使用嵌套数组重命名</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#使用sequelize-fn聚合" class="sidebar-link">使用sequelize.fn聚合</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#使用include额外包括" class="sidebar-link">使用include额外包括</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#使用exclude排除某些表字段" class="sidebar-link">使用exclude排除某些表字段</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#where" class="sidebar-link">where</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#操作符" class="sidebar-link">操作符</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#运算符别名" class="sidebar-link">运算符别名</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#limit-offset-分页-限制" class="sidebar-link">limit, offset(分页, 限制)</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#常用查询方法" class="sidebar-link">常用查询方法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#findall" class="sidebar-link">findAll</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#findone" class="sidebar-link">findOne</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#count" class="sidebar-link">count</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#aggregate聚合查询" class="sidebar-link">aggregate聚合查询</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#findandcountall分页" class="sidebar-link">findAndCountAll分页</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#findorcreate" class="sidebar-link">findOrCreate</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#max" class="sidebar-link">max</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#min" class="sidebar-link">min</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#sum" class="sidebar-link">sum</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#create" class="sidebar-link">create</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#bulkcreate" class="sidebar-link">bulkCreate</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#upsert" class="sidebar-link">upsert</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#update" class="sidebar-link">update</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#describe" class="sidebar-link">describe</a></li><li class="sidebar-sub-header"><a href="/pages/note/part-sequelize/part1.html#destory" class="sidebar-link">destory</a></li></ul></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="orm框架sequelize"><a href="#orm框架sequelize" class="header-anchor">#</a> ORM框架Sequelize</h1> <h2 id="什么是orm"><a href="#什么是orm" class="header-anchor">#</a> 什么是ORM</h2> <p>ORM是<strong>关系型映射</strong>的翻译，英文全称为Object Relational Mapping，它是一种程序设计技术，用于实现面向对象编程语言里不同类型系统的数据之间的转换。效果上表现为在我们操作数据库的时候不需要去写一行行sql语句，而是将关系型数据库映射到一个对象里，在代码中只需要调用这些方法既可以了。</p> <p>在传统的企业应用设计系统中，通常采用MVC的架构方式，其中Model层通常用于处理数据的逻辑关系，这样别会出现数据库操作与业务相关的数据操作强耦合的现象。几十上百行的sql语句会夹杂在业务中，而ORM的出现使对数据库的操作变为对普通对象的操作，对其模型的抽离大大简化了代码。</p> <p>各语言都有各自不同的ORM框架，本文主要介绍nodejs的ORM框架Sequelize,并且只针对到MySQL数据源的介绍</p> <h2 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code>npm install <span class="token operator">--</span>save sequelize
npm install <span class="token operator">--</span>save mysql2
</code></pre></div><h2 id="建立连接"><a href="#建立连接" class="header-anchor">#</a> 建立连接</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//方法1:单独传递参数</span>
<span class="token keyword">const</span> sequelize <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Sequelize</span><span class="token punctuation">(</span><span class="token string">'test'</span><span class="token punctuation">,</span> <span class="token string">'root'</span><span class="token punctuation">,</span> <span class="token string">'Aa04153071.'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    host<span class="token punctuation">:</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>
    port<span class="token punctuation">:</span> <span class="token number">3306</span><span class="token punctuation">,</span>
    dialect<span class="token punctuation">:</span> <span class="token string">'mysql'</span><span class="token punctuation">,</span>
    pool<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        max<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
        min<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        acquire<span class="token punctuation">:</span> <span class="token number">30000</span><span class="token punctuation">,</span><span class="token comment">//抛出错误前保持多少毫秒继续尝试连接</span>
        idle<span class="token punctuation">:</span> <span class="token number">10000</span><span class="token punctuation">,</span><span class="token comment">//在空闲时间保持多少毫秒释放连接</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
// 方法2: 传递连接 URI
const sequelize = new Sequelize('postgres://user:pass@example.com:5432/dbname');*/</span>
</code></pre></div><p>其他配置参数可参考<a href="https://sequelize.org/master/class/lib/sequelize.js~Sequelize.html#instance-constructor-constructor" target="_blank" rel="noopener noreferrer">官方文档--构造函数<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="连接测试"><a href="#连接测试" class="header-anchor">#</a> 连接测试</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>sequelize
    <span class="token punctuation">.</span><span class="token function">authenticate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Connection has been established successfully.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">'Unable to connect to the database:'</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="模型建立"><a href="#模型建立" class="header-anchor">#</a> 模型建立</h2> <p>此处进介绍一种方式</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> User <span class="token operator">=</span> sequelize<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'user_test'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token comment">//可设置字段类型</span>
    <span class="token comment">//可设置是否为空</span>
    <span class="token comment">//可定义主键</span>
    <span class="token comment">//可设置自增</span>
    <span class="token comment">//可设置自定义列名称</span>
    <span class="token comment">//可设置注释</span>
    id<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        type<span class="token punctuation">:</span> DataType<span class="token punctuation">.</span><span class="token constant">INTEGER</span><span class="token punctuation">,</span>
        allowNull<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
        primaryKey<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        autoIncrement<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        comment<span class="token punctuation">:</span> <span class="token string">'这是一个注释'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">//可设置默认值</span>
    <span class="token comment">//可设置唯一索引，当具有相同值的两记录将抛出错误</span>
    <span class="token comment">//多字段设置同一唯一索引将组成联合索引</span>
    uid<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        type<span class="token punctuation">:</span> DataType<span class="token punctuation">.</span><span class="token constant">INTEGER</span><span class="token punctuation">,</span>
        defaultValue<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        unique<span class="token punctuation">:</span> <span class="token string">'index'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    hk_state<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        type<span class="token punctuation">:</span> DataType<span class="token punctuation">.</span><span class="token constant">INTEGER</span><span class="token punctuation">,</span>
        unique<span class="token punctuation">:</span> <span class="token string">'index'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    us_state<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        type<span class="token punctuation">:</span> DataType<span class="token punctuation">.</span><span class="token constant">INTEGER</span><span class="token punctuation">,</span>
        unique<span class="token punctuation">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    as_state<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        type<span class="token punctuation">:</span> DataType<span class="token punctuation">.</span><span class="token constant">INTEGER</span><span class="token punctuation">,</span>
        unique<span class="token punctuation">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    created_at<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        type<span class="token punctuation">:</span> DataType<span class="token punctuation">.</span><span class="token constant">INTEGER</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    updated_at<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        type<span class="token punctuation">:</span> DataType<span class="token punctuation">.</span><span class="token constant">INTEGER</span><span class="token punctuation">,</span>
        <span class="token comment">//属性验证器</span>
        validate<span class="token punctuation">:</span><span class="token punctuation">{</span>
            not<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;[a-z]&quot;</span><span class="token punctuation">,</span><span class="token string">'i'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token comment">// 不允许字母</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token comment">//禁用默认时间戳</span>
    timestamp<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
   	<span class="token comment">// 不删除数据库条目,但将新添加的属性deletedAt设置为当前日期(删除完成时). </span>
  	<span class="token comment">// paranoid 只有在启用时间戳时才能工作</span>
    paranoid<span class="token punctuation">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token comment">//是否启用下划线命名</span>
    underscored<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">//是否禁止修改表名</span>
    freezeTableName<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token comment">// 定义表的名称</span>
    tableName<span class="token punctuation">:</span> <span class="token string">'my_very_custom_table_name'</span><span class="token punctuation">,</span>
    <span class="token comment">// 启用乐观锁定. 启用时,sequelize将向模型添加版本计数属性,</span>
  	<span class="token comment">// 并在保存过时的实例时引发OptimisticLockingError错误.</span>
  	<span class="token comment">// 设置为true或具有要用于启用的属性名称的字符串.</span>
    version<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>   
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>属性验证器信息</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
      is<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;^[a-z]+$&quot;</span><span class="token punctuation">,</span><span class="token string">'i'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>     <span class="token comment">// 只允许字母</span>
      is<span class="token punctuation">:</span> <span class="token regex">/^[a-z]+$/i</span><span class="token punctuation">,</span>          <span class="token comment">// 与上一个示例相同,使用了真正的正则表达式</span>
      not<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;[a-z]&quot;</span><span class="token punctuation">,</span><span class="token string">'i'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>       <span class="token comment">// 不允许字母</span>
      isEmail<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>            <span class="token comment">// 检查邮件格式 (foo@bar.com)</span>
      isUrl<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>              <span class="token comment">// 检查连接格式 (http://foo.com)</span>
      isIP<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>               <span class="token comment">// 检查 IPv4 (129.89.23.1) 或 IPv6 格式</span>
      isIPv4<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>             <span class="token comment">// 检查 IPv4 (129.89.23.1) 格式</span>
      isIPv6<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>             <span class="token comment">// 检查 IPv6 格式</span>
      isAlpha<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>            <span class="token comment">// 只允许字母</span>
      isAlphanumeric<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>     <span class="token comment">// 只允许使用字母数字</span>
      isNumeric<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>          <span class="token comment">// 只允许数字</span>
      isInt<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>              <span class="token comment">// 检查是否为有效整数</span>
      isFloat<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>            <span class="token comment">// 检查是否为有效浮点数</span>
      isDecimal<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>          <span class="token comment">// 检查是否为任意数字</span>
      isLowercase<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>        <span class="token comment">// 检查是否为小写</span>
      isUppercase<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>        <span class="token comment">// 检查是否为大写</span>
      notNull<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>            <span class="token comment">// 不允许为空</span>
      isNull<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>             <span class="token comment">// 只允许为空</span>
      notEmpty<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>           <span class="token comment">// 不允许空字符串</span>
      equals<span class="token punctuation">:</span> <span class="token string">'specific value'</span><span class="token punctuation">,</span> <span class="token comment">// 只允许一个特定值</span>
      contains<span class="token punctuation">:</span> <span class="token string">'foo'</span><span class="token punctuation">,</span>          <span class="token comment">// 检查是否包含特定的子字符串</span>
      notIn<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment">// 检查是否值不是其中之一</span>
      isIn<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span>   <span class="token comment">// 检查是否值是其中之一</span>
      notContains<span class="token punctuation">:</span> <span class="token string">'bar'</span><span class="token punctuation">,</span>       <span class="token comment">// 不允许包含特定的子字符串</span>
      len<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>              <span class="token comment">// 只允许长度在2到10之间的值</span>
      isUUID<span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span>                <span class="token comment">// 只允许uuids</span>
      isDate<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>             <span class="token comment">// 只允许日期字符串</span>
      isAfter<span class="token punctuation">:</span> <span class="token string">&quot;2011-11-05&quot;</span><span class="token punctuation">,</span>    <span class="token comment">// 只允许在特定日期之后的日期字符串</span>
      isBefore<span class="token punctuation">:</span> <span class="token string">&quot;2011-11-05&quot;</span><span class="token punctuation">,</span>   <span class="token comment">// 只允许在特定日期之前的日期字符串</span>
      max<span class="token punctuation">:</span> <span class="token number">23</span><span class="token punctuation">,</span>                  <span class="token comment">// 只允许值 &lt;= 23</span>
      min<span class="token punctuation">:</span> <span class="token number">23</span><span class="token punctuation">,</span>                  <span class="token comment">// 只允许值 &gt;= 23</span>
      isCreditCard<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>       <span class="token comment">// 检查有效的信用卡号码</span>

      <span class="token comment">// 自定义验证器的示例:</span>
      <span class="token function">isEven</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Only even values are allowed!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token function">isGreaterThanOtherField</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>otherField<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Bar must be greater than otherField.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre></div><h2 id="数据类型"><a href="#数据类型" class="header-anchor">#</a> 数据类型</h2> <h3 id="char"><a href="#char" class="header-anchor">#</a> Char</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Sequelize<span class="token punctuation">.</span><span class="token constant">STRING</span>                      <span class="token comment">// VARCHAR(255)</span>
Sequelize<span class="token punctuation">.</span><span class="token constant">STRING</span><span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">)</span>                <span class="token comment">// VARCHAR(1234)</span>
Sequelize<span class="token punctuation">.</span><span class="token constant">STRING</span><span class="token punctuation">.</span><span class="token constant">BINARY</span>               <span class="token comment">// VARCHAR BINARY</span>
Sequelize<span class="token punctuation">.</span><span class="token constant">TEXT</span>                        <span class="token comment">// TEXT</span>
Sequelize<span class="token punctuation">.</span><span class="token constant">TEXT</span><span class="token punctuation">(</span><span class="token string">'tiny'</span><span class="token punctuation">)</span>                <span class="token comment">// TINYTEXT</span>
</code></pre></div><h3 id="number"><a href="#number" class="header-anchor">#</a> Number</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Sequelize<span class="token punctuation">.</span><span class="token constant">INTEGER</span>                     <span class="token comment">// INTEGER</span>
Sequelize<span class="token punctuation">.</span><span class="token constant">BIGINT</span>                      <span class="token comment">// BIGINT</span>
Sequelize<span class="token punctuation">.</span><span class="token constant">BIGINT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>                  <span class="token comment">// BIGINT(11)</span>

Sequelize<span class="token punctuation">.</span><span class="token constant">FLOAT</span>                       <span class="token comment">// FLOAT</span>
Sequelize<span class="token punctuation">.</span><span class="token constant">FLOAT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>                   <span class="token comment">// FLOAT(11)</span>
Sequelize<span class="token punctuation">.</span><span class="token constant">FLOAT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>               <span class="token comment">// FLOAT(11,10)</span>

Sequelize<span class="token punctuation">.</span><span class="token constant">DOUBLE</span>                      <span class="token comment">// DOUBLE</span>
Sequelize<span class="token punctuation">.</span><span class="token constant">DOUBLE</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>                  <span class="token comment">// DOUBLE(11)</span>
Sequelize<span class="token punctuation">.</span><span class="token constant">DOUBLE</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>              <span class="token comment">// DOUBLE(11,10)</span>

Sequelize<span class="token punctuation">.</span><span class="token constant">DECIMAL</span>                     <span class="token comment">// DECIMAL</span>
Sequelize<span class="token punctuation">.</span><span class="token constant">DECIMAL</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>              <span class="token comment">// DECIMAL(10,2)</span>
</code></pre></div><h3 id="time"><a href="#time" class="header-anchor">#</a> Time</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Sequelize<span class="token punctuation">.</span><span class="token constant">DATE</span>                        <span class="token comment">// mysql / sqlite 为 DATETIME, postgres 为带时区的 </span>
Sequelize<span class="token punctuation">.</span><span class="token constant">DATE</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>                     <span class="token comment">// DATETIME(6) 适用 mysql 5.6.4+. 小数秒支持最多6位精度</span>
Sequelize<span class="token punctuation">.</span><span class="token constant">DATEONLY</span>                    <span class="token comment">// DATE 不带时间.</span>

</code></pre></div><h3 id="boolean"><a href="#boolean" class="header-anchor">#</a> Boolean</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Sequelize<span class="token punctuation">.</span><span class="token constant">BOOLEAN</span>                     <span class="token comment">// TINYINT(1)</span>
</code></pre></div><h3 id="enum"><a href="#enum" class="header-anchor">#</a> ENUM</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Sequelize<span class="token punctuation">.</span><span class="token constant">ENUM</span><span class="token punctuation">(</span><span class="token string">'value 1'</span><span class="token punctuation">,</span> <span class="token string">'value 2'</span><span class="token punctuation">)</span>  <span class="token comment">// 一个允许值为'value 1'和'value 2'的ENUM</span>
</code></pre></div><h2 id="常见操作"><a href="#常见操作" class="header-anchor">#</a> 常见操作</h2> <h3 id="属性"><a href="#属性" class="header-anchor">#</a> 属性</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Model<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  attributes<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token string">'bar'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// SELECT foo, bar ...</span>
</code></pre></div><h3 id="使用嵌套数组重命名"><a href="#使用嵌套数组重命名" class="header-anchor">#</a> 使用嵌套数组重命名</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Model<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  attributes<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'bar'</span><span class="token punctuation">,</span> <span class="token string">'baz'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// SELECT foo, bar AS baz ...</span>
</code></pre></div><h3 id="使用sequelize-fn聚合"><a href="#使用sequelize-fn聚合" class="header-anchor">#</a> 使用sequelize.fn聚合</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Model<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  attributes<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>sequelize<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">'COUNT'</span><span class="token punctuation">,</span> sequelize<span class="token punctuation">.</span><span class="token function">col</span><span class="token punctuation">(</span><span class="token string">'hats'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'no_hats'</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// SELECT COUNT(hats) AS no_hats ...</span>
</code></pre></div><h3 id="使用include额外包括"><a href="#使用include额外包括" class="header-anchor">#</a> 使用include额外包括</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Model<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  attributes<span class="token punctuation">:</span> <span class="token punctuation">{</span> include<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>sequelize<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">'COUNT'</span><span class="token punctuation">,</span> sequelize<span class="token punctuation">.</span><span class="token function">col</span><span class="token punctuation">(</span><span class="token string">'hats'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'no_hats'</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// SELECT id, foo, bar, baz, quz, COUNT(hats) AS no_hats ...</span>
</code></pre></div><h3 id="使用exclude排除某些表字段"><a href="#使用exclude排除某些表字段" class="header-anchor">#</a> 使用exclude排除某些表字段</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Model<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  attributes<span class="token punctuation">:</span> <span class="token punctuation">{</span> exclude<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'baz'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="where"><a href="#where" class="header-anchor">#</a> where</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> Op <span class="token operator">=</span> Sequelize<span class="token punctuation">.</span>Op<span class="token punctuation">;</span>

Post<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  where<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    authorId<span class="token punctuation">:</span> <span class="token number">2</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// SELECT * FROM post WHERE authorId = 2</span>

Post<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  where<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    authorId<span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
    status<span class="token punctuation">:</span> <span class="token string">'active'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// SELECT * FROM post WHERE authorId = 12 AND status = 'active';</span>

Post<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  where<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>Op<span class="token punctuation">.</span>or<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>authorId<span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>authorId<span class="token punctuation">:</span> <span class="token number">13</span><span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// SELECT * FROM post WHERE authorId = 12 OR authorId = 13;</span>

Post<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  where<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    authorId<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      <span class="token punctuation">[</span>Op<span class="token punctuation">.</span>or<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// SELECT * FROM post WHERE authorId = 12 OR authorId = 13;</span>

Post<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  where<span class="token punctuation">:</span> sequelize<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span>sequelize<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token string">'char_length'</span><span class="token punctuation">,</span> sequelize<span class="token punctuation">.</span><span class="token function">col</span><span class="token punctuation">(</span><span class="token string">'status'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// SELECT * FROM post WHERE char_length(status) = 6;</span>
</code></pre></div><h3 id="操作符"><a href="#操作符" class="header-anchor">#</a> 操作符</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> Op <span class="token operator">=</span> Sequelize<span class="token punctuation">.</span>Op

<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>and<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>a<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">}</span>           <span class="token comment">// 且 (a = 5)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>or<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>a<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>a<span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">}</span><span class="token punctuation">]</span>  <span class="token comment">// (a = 5 或 a = 6)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>gt<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">,</span>                <span class="token comment">// id &gt; 6</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>gte<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">6</span><span class="token punctuation">,</span>               <span class="token comment">// id &gt;= 6</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>lt<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>               <span class="token comment">// id &lt; 10</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>lte<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>              <span class="token comment">// id &lt;= 10</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>ne<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">,</span>               <span class="token comment">// id != 20</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>eq<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span>                <span class="token comment">// = 3</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>not<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>            <span class="token comment">// 不是 TRUE</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>between<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>     <span class="token comment">// 在 6 和 10 之间</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>notBetween<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 不在 11 和 15 之间</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>in<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>           <span class="token comment">// 在 [1, 2] 之中</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>notIn<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token comment">// 不在 [1, 2] 之中</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>like<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'%hat'</span><span class="token punctuation">,</span>         <span class="token comment">// 包含 '%hat'</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>notLike<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'%hat'</span>       <span class="token comment">// 不包含 '%hat'</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>iLike<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'%hat'</span>         <span class="token comment">// 包含 '%hat' (不区分大小写)  (仅限 PG)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>notILike<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'%hat'</span>      <span class="token comment">// 不包含 '%hat'  (仅限 PG)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>startsWith<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'hat'</span>     <span class="token comment">// 类似 'hat%'</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>endsWith<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'hat'</span>       <span class="token comment">// 类似 '%hat'</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>substring<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'hat'</span>      <span class="token comment">// 类似 '%hat%'</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>regexp<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'^[h|a|t]'</span>    <span class="token comment">// 匹配正则表达式/~ '^[h|a|t]' (仅限 MySQL/PG)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>notRegexp<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'^[h|a|t]'</span> <span class="token comment">// 不匹配正则表达式/!~ '^[h|a|t]' (仅限 MySQL/PG)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>iRegexp<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'^[h|a|t]'</span>    <span class="token comment">// ~* '^[h|a|t]' (仅限 PG)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>notIRegexp<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'^[h|a|t]'</span> <span class="token comment">// !~* '^[h|a|t]' (仅限 PG)</span>
<span class="token punctuation">[</span>Op<span class="token punctuation">.</span>like<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token punctuation">[</span>Op<span class="token punctuation">.</span>any<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'cat'</span><span class="token punctuation">,</span> <span class="token string">'hat'</span><span class="token punctuation">]</span><span class="token punctuation">}</span> <span class="token comment">// 包含任何数组['cat', 'hat'] - 同样适用于 iLike 和 notLike</span>
</code></pre></div><h3 id="运算符别名"><a href="#运算符别名" class="header-anchor">#</a> 运算符别名</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> operatorsAliases <span class="token operator">=</span> <span class="token punctuation">{</span>
  $eq<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>eq<span class="token punctuation">,</span>
  $ne<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>ne<span class="token punctuation">,</span>
  $gte<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>gte<span class="token punctuation">,</span>
  $gt<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>gt<span class="token punctuation">,</span>
  $lte<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>lte<span class="token punctuation">,</span>
  $lt<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>lt<span class="token punctuation">,</span>
  $not<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>not<span class="token punctuation">,</span>
  $<span class="token keyword">in</span><span class="token punctuation">:</span> Op<span class="token punctuation">.</span>in<span class="token punctuation">,</span>
  $notIn<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>notIn<span class="token punctuation">,</span>
  $is<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>is<span class="token punctuation">,</span>
  $like<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>like<span class="token punctuation">,</span>
  $notLike<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>notLike<span class="token punctuation">,</span>
  $iLike<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>iLike<span class="token punctuation">,</span>
  $notILike<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>notILike<span class="token punctuation">,</span>
  $regexp<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>regexp<span class="token punctuation">,</span>
  $notRegexp<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>notRegexp<span class="token punctuation">,</span>
  $iRegexp<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>iRegexp<span class="token punctuation">,</span>
  $notIRegexp<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>notIRegexp<span class="token punctuation">,</span>
  $between<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>between<span class="token punctuation">,</span>
  $notBetween<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>notBetween<span class="token punctuation">,</span>
  $overlap<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>overlap<span class="token punctuation">,</span>
  $contains<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>contains<span class="token punctuation">,</span>
  $contained<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>contained<span class="token punctuation">,</span>
  $adjacent<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>adjacent<span class="token punctuation">,</span>
  $strictLeft<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>strictLeft<span class="token punctuation">,</span>
  $strictRight<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>strictRight<span class="token punctuation">,</span>
  $noExtendRight<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>noExtendRight<span class="token punctuation">,</span>
  $noExtendLeft<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>noExtendLeft<span class="token punctuation">,</span>
  $and<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>and<span class="token punctuation">,</span>
  $or<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>or<span class="token punctuation">,</span>
  $any<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>any<span class="token punctuation">,</span>
  $all<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>all<span class="token punctuation">,</span>
  $values<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>values<span class="token punctuation">,</span>
  $col<span class="token punctuation">:</span> Op<span class="token punctuation">.</span>col
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="limit-offset-分页-限制"><a href="#limit-offset-分页-限制" class="header-anchor">#</a> limit, offset(分页, 限制)</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 获取10个实例/行</span>
Project<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span> limit<span class="token punctuation">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 跳过8个实例/行</span>
Project<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span> offset<span class="token punctuation">:</span> <span class="token number">8</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 跳过5个实例,然后取5个</span>
Project<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span> offset<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> limit<span class="token punctuation">:</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="常用查询方法"><a href="#常用查询方法" class="header-anchor">#</a> 常用查询方法</h2> <h3 id="findall"><a href="#findall" class="header-anchor">#</a> findAll</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Model<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  where<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    attr1<span class="token punctuation">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
    attr2<span class="token punctuation">:</span> <span class="token string">'cake'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="findone"><a href="#findone" class="header-anchor">#</a> findOne</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>Model<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  where<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    attr1<span class="token punctuation">:</span> <span class="token number">42</span><span class="token punctuation">,</span>
    attr2<span class="token punctuation">:</span> <span class="token string">'cake'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="count"><a href="#count" class="header-anchor">#</a> count</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>user_test<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    where<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        id<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            <span class="token punctuation">[</span>Op<span class="token punctuation">.</span>or<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="aggregate聚合查询"><a href="#aggregate聚合查询" class="header-anchor">#</a> aggregate聚合查询</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//params 字段名，聚合函数名</span>
user_test<span class="token punctuation">.</span><span class="token function">aggregate</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'sum'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
    where<span class="token punctuation">:</span><span class="token punctuation">{</span>
        id<span class="token punctuation">:</span><span class="token punctuation">{</span>
            <span class="token punctuation">[</span>Op<span class="token punctuation">.</span>or<span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="findandcountall分页"><a href="#findandcountall分页" class="header-anchor">#</a> findAndCountAll分页</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> ret <span class="token operator">=</span> user_test<span class="token punctuation">.</span><span class="token function">findAndCountAll</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    limit<span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">,</span>
    offset<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ret<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">.</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">.</span>rows<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="findorcreate"><a href="#findorcreate" class="header-anchor">#</a> findOrCreate</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> ret <span class="token operator">=</span> user_test<span class="token punctuation">.</span><span class="token function">findOrCreate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    where<span class="token punctuation">:</span><span class="token punctuation">{</span>
        uid<span class="token punctuation">:</span><span class="token number">10000</span><span class="token punctuation">,</span>
        newUser<span class="token punctuation">:</span><span class="token number">1</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    defaults<span class="token punctuation">:</span><span class="token punctuation">{</span>
        uid<span class="token punctuation">:</span><span class="token number">10000</span><span class="token punctuation">,</span>
        newUser<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span>
        oldUser<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
        hk_task<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
        us_task<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
        as_task<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
        free_task<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
        add_at<span class="token punctuation">:</span><span class="token number">123123123</span><span class="token punctuation">,</span>
        update_at<span class="token punctuation">:</span><span class="token number">123123123</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ret<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token boolean">false</span><span class="token operator">-</span><span class="token operator">&gt;</span>find
ret<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">===</span><span class="token boolean">true</span><span class="token operator">-</span><span class="token operator">&gt;</span>create
</code></pre></div><h3 id="max"><a href="#max" class="header-anchor">#</a> max</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> ret <span class="token operator">=</span> <span class="token keyword">await</span> user_test<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span><span class="token string">'add_at'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="min"><a href="#min" class="header-anchor">#</a> min</h3> <h3 id="sum"><a href="#sum" class="header-anchor">#</a> sum</h3> <h3 id="create"><a href="#create" class="header-anchor">#</a> create</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> ret <span class="token operator">=</span> <span class="token keyword">await</span> user_test<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        uid<span class="token punctuation">:</span><span class="token number">100002</span><span class="token punctuation">,</span>
        newUser<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span>
        oldUser<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
        hk_task<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
        us_task<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
        as_task<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
        free_task<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
        add_at<span class="token punctuation">:</span><span class="token number">123123123</span><span class="token punctuation">,</span>
        update_at<span class="token punctuation">:</span><span class="token number">123123123</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="bulkcreate"><a href="#bulkcreate" class="header-anchor">#</a> bulkCreate</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//返回插入结果的数组</span>
<span class="token keyword">const</span> ret <span class="token operator">=</span> <span class="token keyword">await</span> user_test<span class="token punctuation">.</span><span class="token function">bulkCreate</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            uid<span class="token punctuation">:</span> <span class="token number">100059</span><span class="token punctuation">,</span>
            newUser<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            oldUser<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            hk_task<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            us_task<span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
            as_task<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
            free_task<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            add_at<span class="token punctuation">:</span> <span class="token number">123123123</span><span class="token punctuation">,</span>
            update_at<span class="token punctuation">:</span> <span class="token number">123123123</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            uid<span class="token punctuation">:</span> <span class="token number">100060</span><span class="token punctuation">,</span>
            newUser<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            oldUser<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            hk_task<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
            us_task<span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
            as_task<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
            free_task<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            add_at<span class="token punctuation">:</span> <span class="token number">123123123</span><span class="token punctuation">,</span>
            update_at<span class="token punctuation">:</span> <span class="token number">123123123</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h3 id="upsert"><a href="#upsert" class="header-anchor">#</a> upsert</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//创建或更新一行。如果匹配到主键或唯一约束键时会进行更新。</span>
<span class="token comment">//更新是返回false，创建时返回true</span>
<span class="token keyword">const</span> ret <span class="token operator">=</span> <span class="token keyword">await</span> user_test<span class="token punctuation">.</span><span class="token function">upsert</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        uid<span class="token punctuation">:</span><span class="token number">100002</span><span class="token punctuation">,</span>
        newUser<span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">,</span>
        oldUser<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
        hk_task<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
        us_task<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
        as_task<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
        free_task<span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span>
        add_at<span class="token punctuation">:</span><span class="token number">123123123</span><span class="token punctuation">,</span>
        update_at<span class="token punctuation">:</span><span class="token number">123123123</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="update"><a href="#update" class="header-anchor">#</a> update</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//批量更新是只需控制where条件就行</span>
<span class="token comment">//返回数组，只有一个元素，标识更新的数量</span>
<span class="token keyword">const</span> ret <span class="token operator">=</span> <span class="token keyword">await</span> user_test<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>
        <span class="token punctuation">{</span>
            newUser<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            oldUser<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            hk_task<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
            us_task<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
            where<span class="token punctuation">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="describe"><a href="#describe" class="header-anchor">#</a> describe</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//查询表信息</span>
<span class="token keyword">const</span> ret <span class="token operator">=</span> <span class="token keyword">await</span> user_test<span class="token punctuation">.</span><span class="token function">describe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="destory"><a href="#destory" class="header-anchor">#</a> destory</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//返回删除的记录数</span>
<span class="token keyword">const</span> ret <span class="token operator">=</span> <span class="token keyword">await</span> user_test<span class="token punctuation">.</span><span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        where<span class="token punctuation">:</span><span class="token punctuation">{</span>
            uid<span class="token punctuation">:</span><span class="token punctuation">{</span>
                <span class="token punctuation">[</span>Op<span class="token punctuation">.</span>or<span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">100059</span><span class="token punctuation">,</span><span class="token number">100060</span><span class="token punctuation">,</span><span class="token number">100001</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.4e796291.js" defer></script><script src="/assets/js/2.5955c47d.js" defer></script><script src="/assets/js/42.2df722e2.js" defer></script>
  </body>
</html>
